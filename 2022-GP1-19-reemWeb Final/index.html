<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin_Dashboard</title>
    <!---- MATERIAL CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">   
    <!----STYLESHEET -->
    <link rel="stylesheet" href="./style.css"> 
    <script type="text/javascript"
    src=" https://npmcdn.com/parse/dist/parse.min.js"> 
</script> 
</head>
<body>
    <script>

         // Initialize Parse
         Parse.initialize("0RlD4YgWV75gUlCXVcHr33pzfYN3ilb1qrFWyUy5",
         "kJ7mcY3FfZ35jn4unoEATfZCbQQBVz3LvPJKTLCW"); 
           Parse.serverURL = "https://parseapi.back4app.com/";


  //Check if user logged in
  async function sessionCheck(){
     const currentUser = await Parse.User.current();
     if (currentUser === null) {
        window.location.replace("log_in_page.html");
     }
  }
  sessionCheck();

  //User log out
async function doUserLogOut () {
    try {
        await Parse.User.logOut();
        // To verify that current user is now empty, currentAsync can be used
        const currentUser = await Parse.User.current();
        if (currentUser === null) {
            alert('Success! No user is logged in anymore!');
        }
        // Update state variable holding current user
        getCurrentUser();
        //return window.location.replace("log_in_page.html");
    } catch (error) {
        alert(`Error! ${error.message}`);
        return false;
    }    
};

// function date(){
//     const date = new Date();
//     alert(date);
//     document.getElementById('date').innerHTML=date;
// }
// date();

async function retriveTotalCustomers(){
    var count =0;
    const query = new Parse.Query("Customer");
    const results = await query.find();
    for (let i = 0; i < results.length; i++) {
        count = count+1;
    }
    //display number of results
document.getElementById('Tcustomers').innerHTML =count;


}
retriveTotalCustomers();

async function retriveTotalPharmacies(){
    var count =0;
    const query = new Parse.Query("Pharmacist");
    const results = await query.find();
    for (let i = 0; i < results.length; i++) {
        count = count+1;
    }
    //display number of results
document.getElementById('Tpharmacies').innerHTML =count;


}
retriveTotalPharmacies();

retriveTotalCustomers();

async function retriveTotalOrders(){
    var count =0;
    const query = new Parse.Query("Orders");
    const results = await query.find();
    for (let i = 0; i < results.length; i++) {
        count = count+1;
    }
    //display number of results
document.getElementById('TOrders').innerHTML =count;


}
retriveTotalOrders();

async function RetriveAdminInfo(){
    const query = new Parse.Query("Admin");
    
    const results = await query.find();
    for (let i = 0; i < results.length; i++) {
        count = count+1;
    }
    //display number of results
document.getElementById('AdminName').innerHTML =count;


}
RetriveAdminInfo();

    </script>
    <div class="container">
        <aside class="aside">
        <div class="top">
            <div class="logo">
                <img src="./images/logo.png">
                <h2>Tiryaq</h2>
            </div>
            <div class="close" id="close-btn">
                <i class="fa fa-times" aria-hidden="true"></i>
                 </div>
        </div>
        <div class="sidebar">
            <a href="index.html" class="active">
                <i class="fa fa-th-large" aria-hidden="true"></i>
                <h3>Dashboard</h3>
            </a>
            <a href="ViewCustomers.html">
                <i class="fa fa-users" aria-hidden="true"></i>
                <h3>Customers</h3>
            </a>
            <a href="Pharmacies_page.html">
                <i class="fa fa-plus-square" aria-hidden="true"></i>
                <h3>Pharmacies</h3>
            </a>
          
            <a href="Pharmacies_Join_Request_Page.html">
                <i class="fa fa-envelope" aria-hidden="true"></i>
                <h3>Join requests</h3>
            </a>
            <a href="Medications.html" >
                <i class="fa fa-medkit" aria-hidden="true"></i>
                <h3>Medications</h3>
            </a>
            <a href="AddMedication.html">
                <i class="fa fa-plus" aria-hidden="true"></i>
                <h3>Add Medications</h3>
            </a>
            <a href="customerOrders.html" >
                <i class="fa fa-list-alt" aria-hidden="true"></i>
                <h3>Orders</h3>
            </a>
            <a href="" onclick="doUserLogOut()">
                <i class="fa fa-sign-out" aria-hidden="true"></i>
                <h3>Log out</h3>
            </a>
        </div>
        </aside>
        <!----------------------------------END OF ASIDE-------------->
        <main>
            <h1>Admin Dashboard</h1>

            <!-- <div class="date">
                <input type="date">
            </div> -->
 <!--------------------------- insights ----------------------------> 
            <div class="insights">
                <div class="customers">
                <i class="fa fa-users" aria-hidden="true"></i> 
                <div class="middile">
                    <div class="left">
                        <h3>Total customers</h3>
                        <h1 id="Tcustomers" ></h1>
                    </div>
                    <div class="progress">
                        <!-- <svg>
                            <circle cx='45' cy="38" r="36"></circle>
                        </svg> -->
                        <!-- <div class="number">
                         <p>81%</p>
                        </div>  -->
                    </div>
                </div> 
                </div>
                <!--------------END OF CUSTOMERS----------->
                <div class="pharmacies">
                    <i class="fa fa-plus-square" aria-hidden="true"></i> 
                    <div class="middile">
                        <div class="left">
                            <h3>Total pharmacies</h3>
                            <h1 id="Tpharmacies"></h1>
                        </div>
                        <div class="progress">
                            <!-- <svg>
                                <circle cx='38' cy="38" r="36"></circle>
                            </svg> -->
                            <!-- <div class="number">
                                <p>47%</p>
                            </div>  -->
                        </div>
                    </div> 
                    </div>
                    <!--------------END OF PHARMACIES----------->
                    <div class="orders">
                        <i class="fa fa-list-alt" aria-hidden="true"></i>
                        <div class="middile">
                            <div class="left">
                                <h3>Total orders</h3>
                                <h1 id="TOrders"></h1>
                            </div>
                            <div class="progress">
                                <!-- <svg>
                                    <circle cx='38' cy="38" r="36"></circle>
                                </svg> -->
                                <div class="number">
                                    <!-- <p>37%</p> -->
                                </div> 
                            </div>
                        </div> 
                        </div>
                        <!--------------END OF ORDERS----------->   
                         
            </div>
            <!---------------------------END OF insights ----------------------------> 

        </main>
        <!------------------------- END OF MAIN ------------------>

        <div class="right">
            <!---------------TOP -->
            <div class="top">
                <button  class="o" id="menu-btn">
                    <i class="fa fa-bars" aria-hidden="true"></i>
                </button>
                <div class="theme-toggler">
                    <i class="fa fa-sun-o active"aria-hidden="true"></i>
                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                </div>
                <div class="profile">
                    <div class="info">
                        <p id="adminName"><</p>
                        <small class="text-muted">Admin</small>
                    </div>
                    <div class="profile-photo">
                        <img src="./images/profile.jpg">
                    </div>
                </div>
            </div>
            <!---------------END TOP -->
            <div class="recent-updates">
                <h2>Recent Updates</h2>
                <div class="updates">
                    <div class="updat">
                        <div class="profile-photo">
                            <img src="./images/profile2.jpg">
                        </div>
                        <div class="message">
                            <p><b>Nuora Alfouzan</b> Ordered from alnahdi jfvfgvkbkjjjjdgvjbjdvgljnglhbkh</p>
                            <small class="text-muted">1 min ago</small>
                        </div>
                    </div>

                    <div class="updat">
                        <div class="profile-photo">
                            <img src="./images/profile3.jpg">
                        </div>
                        <div class="message">
                            <p><b>Reem Alrashed </b> Ordered from rashad jvkgvbghfbhkgjhfjkjbfkbkjbkjbhkjb</p>
                            <small class="text-muted">2 min ago</small>
                        </div>
                    </div>

                    <div class="updat">
                        <div class="profile-photo">
                            <img src="./images/profile4.jpg">
                        </div>
                        <div class="message">
                            <p><b>Shahad almasoud </b> Ordered from boots  hjhghfkbfjbfjxlijbxfilgjbz;j;zig</p>
                            <small class="text-muted">3 min ago</small>
                        </div>
                    </div>
                </div>
            </div>
            <!----------------------- END OF RECENT UPDATES---------------------------->
            <div class="sales-analytics">
                <h2>progress Analytics</h2>

                <div class="item collicted">
                    <div class="icon">
                        <i class="fa fa-shopping-bag" aria-hidden="true"></i>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>picked-up orders</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="success">+39%</h5>
                        <h3>3849</h3>
                    </div>
                </div>
                <!----------------------------------------------->
                <div class="item Canceled">
                    <div class="icon">
                        <i class="fa fa-ban" aria-hidden="true"></i>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>Canceled orders</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="danger">+17%</h5>
                        <h3>76</h3>
                    </div>
                </div>
                <!-------------------------------------------------->
                <div class="item customers">
                    <div class="icon">
                        <i class="fa fa-user" aria-hidden="true"></i>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>New customers</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="success">+25%</h5>
                        <h3>234</h3>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>  
</body>
</html>